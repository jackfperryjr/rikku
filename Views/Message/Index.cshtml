@model IEnumerable<Rikku.Models.ApplicationUserViewModel>
@using Rikku.Models
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    var user = await UserManager.GetUserAsync(User);
    var color = "#000000";
}
<h3 class="ffapp" style="position:fixed;left:0;background-color:#000000;padding:0 0 5px 40%;width:100vw;background-color: rgba(0,0,0,.9);">messages</h3>
<div class="container" style="padding:40px 0 0 0;">
    <div class="container" style="padding:0;"> 
    @foreach(var users in Model) 
    {
        @if(users.MessageReadFlg == 0)
        {
            color = "#212121!important";
        }
        else 
        {
            color = "#000000!important";
        }

        @if(users.Email != user.Email)
        {
            @if(users.DeletedBy1 != user.Id || users.DeletedBy2 != user.Id)
            {    
                
                <div class="row" style="margin:0 0 20px 0;background-color:@color;">
                    <div class="col-xs-4" style="margin:0 20px 0 0;padding-left:10px;">
                        <a asp-action="Chat" asp-route-id="@users.Id">
                            @if(users.MessageReadFlg == 0)
                            {
                                <div style="position:relative;border-radius:50%;height:55px;width:55px;background-image:linear-gradient(to bottom right, #fff,#0d47a1,#9933CC);">
                                    <img src="@users.Picture" style="border-radius:50%;width:50px;height:50px;margin:auto;position:absolute;top:-50%;right:-50%;bottom:-50%;left:-50%;">
                                </div>
                            } 
                            else 
                            {
                                <img src="@users.Picture" style="border-radius:50%;width:50px;height:50px;">
                            }
                        </a>
                    </div>
                    <div class="col-xs-6" style="margin:0;padding-top:5px;text-align:left;">
                        <a asp-action="Chat" asp-route-id="@users.Id" style="display:inline;">
                            <span style="font-size: 14px;">@users.UserName</span><br/>
                            <span style="font-size: 12px;">@users.CreateDate.ToShortDateString()</span>
                        </a>
                    </div>
                    
                    <div class="col-xs-2" style="margin:0 0 0 auto;padding-top:5px;padding-right:10px;">
                        <a class="btn btn-link bg-danger" style="font-size:14px;border-radius:50%;" data-toggle="modal" href="@("#deleteModal" + users.Id)"><i class="fas fa-trash" style="color:#ffffff!important;"></i></a>
                        <div class="modal fade top-margin" id="@("deleteModal" + users.Id)" tabindex="-1" role="dialog">
                            <div class="modal-dialog">
                                <div class="modal-content text-center">
                                    @using(Html.BeginForm("DeleteChat", "Message"))
                                    {
                                    <input type="hidden" value="@users.Id" name="id" />
                                    <div class="modal-header" style="border:none!important;border:none!important;border-bottom-top-radius:0!important;border-top-left-radius:0!important;">
                                        <h4 class="modal-title">Confirm</h4>
                                        <button type="button" class="close pull-right" data-dismiss="modal">&times;</button>
                                    </div>
                                    <div class="modal-body" style="border:none!important;background-color:#212121!important;">
                                        <p>Are you sure you want to delete these messages?</p>
                                    </div>
                                    <div class="modal-footer" style="border:none!important;border-bottom-right-radius:0!important;border-bottom-left-radius:0!important;background-color:#212121!important;">
                                        <button type="submit" class="btn btn-danger">Yes</button>
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                    </div>
                                    }
                                </div>
                            </div>
                        </div> 
                    </div>
                </div>
            }
        }
    }
    </div>
</div>